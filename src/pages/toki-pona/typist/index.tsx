import { Heading } from "@/components/Heading"
import { Index, createSignal } from "solid-js"

export type Key = readonly [
  standard: string,

  main: string,
  shift: string,
  alt: string,
  altShift: string,
]

const KEY_DATA = [
  [
    ["`", "(", ")", "<", ">"],
    ["1", "ó±¥³", "ó±¤¹", "ó±¥—", "ó±¥¹"],
    ["2", "ó±¥®", "ó±¤¾", "ó±¥‘", "ó±¤"],
    ["3", "ó±¤¼", "ó±¤½", "ó±¤‹", "ó±¥½"],
    ["4", "ó±¥©", "ó±¤ˆ", "ó±¤²", "ó±¦¡"],
    ["5", "ó±¤­", "ó±¥Œ", "ó±¥ƒ", "ó±¥»"],
    ["6", "ó±¤¨", "ó±¥£", "ó±¥¦", "ó±¦ƒ"],
    ["7", "ó±¤Š", "ó±¥¢", "ó±¥´", "ó±¦€"],
    ["8", "ó±¤–", "ó±¥¶", "ó±¤¦", "ó±¥¸"],
    ["9", "ó±¤„", "ó±¦", "ó±¥‡", "ó±¦£"],
    ["0", "ó±¤‚", "ó±¦‘", "ó±¥‹", "ğŸ—§"],
    ["-", "â€", "â€", "ó±¦“", "ó±¦’"],
    ["=", "ó±¦•", "ó±¦–", "ó±¦”", "ó±¦™"],
  ],
  [
    ["q", "ó±¥™", "ó±¥¤", "ó±¤œ", "ó±¤º"],
    ["w", "ó±¤¡", "ó±¥µ", "ó±¥š", "ó±¥²"],
    ["e", "ó±¤‰", "ó±¥–", "ó±¥“", "ó±¥¼"],
    ["r", "ó±¥«", "ó±¤¤", "ó±¤«", "ó±¦‡"],
    ["t", "ó±¥¬", "ó±¥­", "ó±¥¥", "ó±¥¾"],
    ["y", "ó±¤¬", "ó±¤‡", "ó±¤—", "ó±¦"],
    ["u", "ó±¥", "ó±¤•", "ó±¥°", "ó±¥¯"],
    ["i", "ó±¤", "ó±¤", "ó±¤", "ó±¦‚"],
    ["o", "ó±¥„", "ó±¤Œ", "ó±¥œ", "ó±¥º"],
    ["p", "ó±¥”", "ó±¥ˆ", "ó±¥’", "ó±¥•"],
    ["[", "ó±¦—", "ó±¦š", "[", "{"],
    ["]", "ó±¦˜", "ó±¦›", "]", "}"],
    ["\\", "/", "_", "\\", "|"],
  ],
  [
    ["a", "ó±¤€", "ó±¤†", "ó±¤”", "ó±¤…"],
    ["s", "ó±¥¡", "ó±¥ ", "ó±¥›", "ó±¥˜"],
    ["d", "ó±¥¨", "ó±¤ª", "ó±¤¥", "ó±¤ƒ"],
    ["f", "ó±¥", "ó±¥", "ó±¤š", "ó±¦ "],
    ["g", "ó±¥†", "ó±¤Ÿ", "ó±¤£", "ó±¦…"],
    ["h", "ó±¥‚", "ó±¥", "ó±¥Š", "ó±¦¢"],
    ["j", "ó±¤‘", "ó±¤“", "ó±¤", "ó±¤’"],
    ["k", "ó±¤˜", "ó±¤™", "ó±¤›", "ó±¦ˆ"],
    ["l", "ó±¤§", "ó±¤®", "ó±¤©", "ó±¤¯"],
    [";", "ó±¦œ", "ó±¦", ";", ":"],
    ["'", "'", '"', "+", "*"],
  ],
  [
    ["z", "ó±¥§", "ó±¤¢", "ó±¤·", "ó±¤¸"],
    ["x", "ó±¥‰", "ó±¤¶", "ó±¥±", "ó±¥Ÿ"],
    ["c", "ó±¥", "ó±¥…", "ó±¤", "ó±¦„"],
    ["v", "ó±¥·", "ó±¥ª", "ó±¤", "ó±¥¿"],
    ["b", "ó±¥", "ó±¤¿", "ó±¥", "ó±¤µ"],
    ["n", "ó±¦†", "ó±¤»", "ó±¤ ", "ó±¥€"],
    ["m", "ó±¤´", "ó±¤°", "ó±¤±", "ó±¤³"],
    [",", "ã€", "ã€Œ", ",", "ã€"],
    [".", "ã€‚", "ã€", ".", "ã€"],
    ["/", "-", "=", "!", "?"],
  ],
]

function splitByCodePoint(text) {
  const output = []
  let index = 0
  let value

  while (((value = text.codePointAt(index)), value != null)) {
    output.push(String.fromCodePoint(value))
    index += String.fromCodePoint(value).length
  }

  return output
}

function getKeyData() {
  function makeRow(data) {
    if (data.length != 5) {
      throw new Error("Expected five rows of data.")
    }

    const [standard, main, shift, alt, altShift] = data.map(splitByCodePoint)

    return standard.map((standard, index) => [
      standard,
      main[index],
      shift[index],
      alt[index],
      altShift[index],
    ])
  }

  const KEY_DATA = `
\`1234567890-=
(ó±¥³ó±¥®ó±¤¼ó±¥©ó±¤­ó±¤¨ó±¤Šó±¤–ó±¤„ó±¤‚â€ó±¦•)
)ó±¤¹ó±¤¾ó±¤½ó±¤ˆó±¥Œó±¥£ó±¥¢ó±¥¶ó±¦ó±¦‘â€ó±¦–
<ó±¥—ó±¥‘ó±¤‹ó±¤²ó±¥ƒó±¥¦ó±¥´ó±¤¦ó±¥‡ó±¥‹ó±¦“ó±¦”
>ó±¥¹ó±¤ó±¥½ó±¦¡ó±¥»ó±¦ƒó±¦€ó±¥¸ó±¦£ğŸ—§ó±¦’ó±¦™
qwertyuiop[]\\
ó±¥™ó±¤¡ó±¤‰ó±¥«ó±¥¬ó±¤¬ó±¥ó±¤ó±¥„ó±¥”ó±¦—ó±¦˜/
ó±¥¤ó±¥µó±¥–ó±¤¤ó±¥­ó±¤‡ó±¤•ó±¤ó±¤Œó±¥ˆó±¦šó±¦›_
ó±¤œó±¥šó±¥“ó±¤«ó±¥¥ó±¤—ó±¥°ó±¤ó±¥œó±¥’[]\\
ó±¤ºó±¥²ó±¥¼ó±¦‡ó±¥¾ó±¦ó±¥¯ó±¦‚ó±¥ºó±¥•{}|
asdfghjkl;'
ó±¤€ó±¥¡ó±¥¨ó±¥ó±¥†ó±¥‚ó±¤‘ó±¤˜ó±¤§ó±¦œ'
ó±¤†ó±¥ ó±¤ªó±¥ó±¤Ÿó±¥ó±¤“ó±¤™ó±¤®ó±¦"
ó±¤”ó±¥›ó±¤¥ó±¤šó±¤£ó±¥Šó±¤ó±¤›ó±¤©;+
ó±¤…ó±¥˜ó±¤ƒó±¦ ó±¦…ó±¦¢ó±¤’ó±¦ˆó±¤¯:*
zxcvbnm,./
ó±¥§ó±¥‰ó±¥ó±¥·ó±¥ó±¦†ó±¤´ã€ã€‚-
ó±¤¢ó±¤¶ó±¥…ó±¥ªó±¤¿ó±¤»ó±¤°ã€Œã€=
ó±¤·ó±¥±ó±¤ó±¤ó±¥ó±¤ ó±¤±,.!
ó±¤¸ó±¥Ÿó±¦„ó±¥¿ó±¤µó±¥€ó±¤³ã€ã€?
`
    .trim()
    .split("\n")

  return [
    makeRow(KEY_DATA.slice(0, 5)),
    makeRow(KEY_DATA.slice(5, 10)),
    makeRow(KEY_DATA.slice(10, 15)),
    makeRow(KEY_DATA.slice(15, 20)),
  ]
}

export function Main() {
  const [prompt, setPrompt] = createSignal({
    answer: "ó±¥¬ó±¥”ó±¦œ",
    typed: "",
  })

  return (
    <div class="mt-auto flex w-full max-w-lg flex-1 flex-col">
      <Heading>o pana e sitelen pona ni:</Heading>

      <CharTable />
    </div>
  )
}
